I am using drake in an exploratory analysis in systems biology. In line with the philosophy of drake, I want to pull the generation of plots out of the Rmd and include them in the drake plan, so as to be explicit about their dependencies and to cache results. The latter point is particularly important for 'heavy' plots, which take long to generate. This is straightforward when the plots are R objects (e.g. generated by ggplot), the approach is identical to any other object. Howver, sometimes a certain package function will plot to the "base" graphics device. Now the plot is constructed line-by-line, and therefore harder to capture as an object. There are [ways](https://www.andrewheiss.com/blog/2016/12/08/save-base-graphics-as-pseudo-objects-in-r/) to do this, but for some purposes it might be easier to just generate a png and include that in the report. 

Yet the png image might change when the data it depends on change, in which case the report should be updated as well. Therefore: **Is there a way to use drake to include image _files_ in the Rmd report and explicitly model them as dependencies of the Rmd report?**
  
  As a minimal example, consider following drake plan `my_drake_plan.R`:
  
  ``` r
plan1 = drake_plan(
  
  pval_data = runif(1000),  # in reality: n > 10^9
  
  # make qq plot as png file
  qq = make_qq(v_pval = pval_data, fig_path = file_out("results/qq.png")),
  
  # generate report, which is to include the png
  report = rmarkdown::render(
    knitr_in("EDA.Rmd"),
    output_file = file_out(here::here("results/EDA_report.html")),
    quiet = TRUE
  )
)
```

Which would be called with the minimal master script `make.R`:
  
  ```r
# based on https://github.com/wlandau/drake-examples/blob/master/gsp/make.R, 21/04/2019

# explicit library imports and functions definitions defined
# here in the master script for sake of simplicity

library(qqman)
library(drake)

make_qq <- function(v_pval, fig_path){
  png(fig_path, res=600,
      width = 6, height = 6, units = "in")
  qqman::qq(v_pval)
  dev.off()
  
}

source(here::here("my_drake_plan.R"))


# graph of workflow
config <- drake_config(plan) # nolint
vis_drake_graph(config)

make(plan)
```

And has as final target following minimal Rmd `EDA.Rmd`:
  
  ```Rmd 
---
  title: "explore association p-values"
output: html_document
---
  
  # Quality control
  
  drake issue: including images can be problematic. Since they are not located in the code chunks/inline code, there is no dependency being generated?
  
  p-value QQ-plot:
  
  ![](results/qq.png)
``` 


As I understand from the docs, drake scans the Rmd file for dependencies through identification of `readd(myvar)` or `loadd(myvar)`, but does not recognise included images as dependencies. Indeed, the graph looks like this:
  
  ![image](https://user-images.githubusercontent.com/14093839/56496408-31fbeb00-64f1-11e9-8224-ae8a43e37c3d.png)







<sup>Created on 2019-04-22 by the [reprex package](https://reprex.tidyverse.org) (v0.2.1)</sup>